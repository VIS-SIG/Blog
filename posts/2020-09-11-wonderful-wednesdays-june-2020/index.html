<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

  <!--radix_placeholder_meta_tags-->
<title>VIS-SIG Blog: Wonderful Wednesdays June 2020</title>

<meta property="description" itemprop="description" content="This month the discussion is about visualizations of the satisfaction data using cumulative distribution functions, a tree plot, staggered bar plots, a power BI dashboard and two interactive funnel plots using plotly and RShiny. These examples nicely demonstrate that different displays support different purposes. Some visualizations are telling a story about the data and others help to explore the data. Presented by Bodo Kirsch."/>

<link rel="canonical" href="https://vis-sig.github.io/blog/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2020-06-10"/>
<meta property="article:created" itemprop="dateCreated" content="2020-06-10"/>
<meta name="article:author" content="Markus Vogler"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="VIS-SIG Blog: Wonderful Wednesdays June 2020"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="This month the discussion is about visualizations of the satisfaction data using cumulative distribution functions, a tree plot, staggered bar plots, a power BI dashboard and two interactive funnel plots using plotly and RShiny. These examples nicely demonstrate that different displays support different purposes. Some visualizations are telling a story about the data and others help to explore the data. Presented by Bodo Kirsch."/>
<meta property="og:url" content="https://vis-sig.github.io/blog/"/>
<meta property="og:image" content="https://vis-sig.github.io/blog/./plots/cdf.png"/>
<meta property="og:image:width" content="4133"/>
<meta property="og:image:height" content="2362"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="VIS-SIG Blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="VIS-SIG Blog: Wonderful Wednesdays June 2020"/>
<meta property="twitter:description" content="This month the discussion is about visualizations of the satisfaction data using cumulative distribution functions, a tree plot, staggered bar plots, a power BI dashboard and two interactive funnel plots using plotly and RShiny. These examples nicely demonstrate that different displays support different purposes. Some visualizations are telling a story about the data and others help to explore the data. Presented by Bodo Kirsch."/>
<meta property="twitter:url" content="https://vis-sig.github.io/blog/"/>
<meta property="twitter:image" content="https://vis-sig.github.io/blog/./plots/cdf.png"/>
<meta property="twitter:image:width" content="4133"/>
<meta property="twitter:image:height" content="2362"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="VIS-SIG Blog: Wonderful Wednesdays June 2020"/>
<meta name="citation_fulltext_html_url" content="https://vis-sig.github.io/blog/"/>
<meta name="citation_online_date" content="2020/06/10"/>
<meta name="citation_publication_date" content="2020/06/10"/>
<meta name="citation_author" content="Markus Vogler"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","slug","base_url","preview","output","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Wonderful Wednesdays June 2020"]},{"type":"character","attributes":{},"value":["This month the discussion is about visualizations of the satisfaction data using cumulative distribution functions, a tree plot, staggered bar plots, a power BI dashboard and two interactive funnel plots using plotly and RShiny. These examples nicely demonstrate that different displays support different purposes. Some visualizations are telling a story about the data and others help to explore the data. Presented by Bodo Kirsch."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Markus Vogler"]},{"type":"character","attributes":{},"value":["https://www.psiweb.org/sigs-special-interest-groups/visualisation"]}]}]},{"type":"character","attributes":{},"value":["06-10-2020"]},{"type":"character","attributes":{},"value":["Wonderful Wednesdays","Subgroups","Discrete endpoint"]},{"type":"character","attributes":{},"value":["june-2020-ww"]},{"type":"character","attributes":{},"value":["https://vis-sig.github.io/blog"]},{"type":"character","attributes":{},"value":["./plots/cdf.png"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["https://vis-sig.github.io/blog/"]},{"type":"character","attributes":{},"value":["https://vis-sig.github.io/blog/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["codes/cdf - Markus Vogler.R","codes/code_to_submit - 辉孙.R","codes/Cohort 1_0 - Philip Griffiths.R","codes/pbi - manz352.txt","codes/psi_may2020 - Blin Blingineer.R","codes/subscreen_ww2005.R","Octocat.jpg","plots/bar.png","plots/cdf.png","plots/funnel1.png","plots/funnel2.png","plots/powerbi.png","plots/tree.png","wonderful-wednesdays-june-2020_files/bowser-1.9.3/bowser.min.js","wonderful-wednesdays-june-2020_files/distill-2.2.21/template.v2.js","wonderful-wednesdays-june-2020_files/jquery-1.11.3/jquery.min.js","wonderful-wednesdays-june-2020_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

</style>

<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createIndex() {
  var options = {
    keys: [
      "title",
      "categories",
      "description",
      "contents"
    ]
  };
  return new window.Fuse([],options);
}

function createFuseIndex() {

  // create fuse index
  var options = { keys: ["title", "description", "contents"] };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
            keys: [
              { name: 'title', weight: 20 },
              { name: 'categories', weight: 15 },
              { name: 'description', weight: 10 },
              { name: 'contents', weight: 5 },
            ],
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
            .filter(function(item) { return !!item.description; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description}
                </div>
                <div class="search-item-preview">
                  <img src="${suggestion.preview ? offsetURL(suggestion.preview) : ''}"</img>
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: hidden;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
	font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
/* only text inside of <p> tags */
d-article > p {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}

/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
	font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
	font-size: var(--aside-size, 12px);
	color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
	font-size: var(--fig-cap-size, 13px);
	color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
	font-size: var(--heading-size, 0.6rem);
	color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
	font-size: var(--body-size, 0.8rem);
	color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
	color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
	font-size: var(--heading-size, 18px);
}

.d-contents nav a {
	font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
	color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
	color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
	color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
	font-size: var(--title-size, 18px);
	font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a {
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a:hover {
	color: var(--hover-color, white);
}

.distill-site-header {
	font-size: var(--text-size, 15px);
	color: var(--text-color, rgba(255, 255, 255, 0.8));
	background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
	font-size: var(--text-size, 15px);
	color: var(--text-color, rgba(255, 255, 255, 0.8));
	background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
	color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Wonderful Wednesdays June 2020","description":"This month the discussion is about visualizations of the satisfaction data using cumulative distribution functions, a tree plot, staggered bar plots, a power BI dashboard and two interactive funnel plots using plotly and RShiny. These examples nicely demonstrate that different displays support different purposes. Some visualizations are telling a story about the data and others help to explore the data. Presented by Bodo Kirsch.","authors":[{"author":"Markus Vogler","authorURL":"https://www.psiweb.org/sigs-special-interest-groups/visualisation","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2020-06-10T00:00:00.000+02:00","citationText":"Vogler, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<span class="logo">
<img src="../../WWW_logo_cut.png"/>
</span>
<a href="../../index.html" class="title">VIS-SIG Blog</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="https://www.psiweb.org/sigs-special-interest-groups/visualisation/welcome-to-wonderful-wednesdays">Wonderful Wednesdays</a>
<a href="https://www.psiweb.org/sigs-special-interest-groups/visualisation">PSI SIG page</a>
<a href="https://lp.constantcontactpages.com/su/Ea7OsL8">Sign up</a>
<a href="../../about.html">About</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Wonderful Wednesdays June 2020</h1>
<p>This month the discussion is about visualizations of the satisfaction data using cumulative distribution functions, a tree plot, staggered bar plots, a power BI dashboard and two interactive funnel plots using plotly and RShiny. These examples nicely demonstrate that different displays support different purposes. Some visualizations are telling a story about the data and others help to explore the data. Presented by Bodo Kirsch.</p>
</div>

<div class="d-byline">
  Markus Vogler <a href="https://www.psiweb.org/sigs-special-interest-groups/visualisation" class="uri">https://www.psiweb.org/sigs-special-interest-groups/visualisation</a> 
  
<br/>06-10-2020
</div>

<div class="d-article">
<p>The example dataset for this month’s webinar was based on a survey of overall satisfaction performed in Germany in 2014 and <a href="http://dx.doi.org/10.4232/1.12437">published in 2016</a>. The primary endpoint was overall satisfaction with life.</p>
<p>The question posed to the participants was: “How would you rate your satisfaction with your life overall on a scale from 0-10?”, where 10 means completely satisfied. There was only one observation per participant and no treatment groups, as no treatment was administered.</p>
<p>The objective of this survey was to explore the most relevant factors for satisfaction in life. Several factors, such as smoking status, working hours per week or number of doctor visits per year were collected. The dataset and its specification can be found here <a href="https://github.com/VIS-SIG/Wonderful-Wednesdays/tree/master/data/2020/2020-05-13">here</a>. <!-- [![here](Octocat.jpg){width=5%}](https://github.com/VIS-SIG/Wonderful-Wednesdays/tree/master/data/2020/2020-05-13). --></p>
<p>We received a variety of submissions and we would like to thank everyone for their contributions. The visualizations that were presented during the June 2020 Wonderful Wednesday webinar are described below, with a few discussion points highlighted. To see the full discussion around each of the visualizations, check out the webinar recording in the <a href="https://www.psiweb.org/vod/item/psi-vissig-webinar-wonderful-wednesday-4">PSI Video-on-Demand library</a>. The subtitles contain the timestamps of the webinar recording, in case you would like to listen to the discussion around a specific visualization.</p>
<p><a id="example1"></a></p>
<h1 id="example-1.-cdf-plot-0310---0850">Example 1. CDF plot (03:10 - 08:50)</h1>
<figure>
<img src="plots/cdf.png" title="Plot 1" alt="Plot 1" /><figcaption>Plot 1</figcaption>
</figure>
<p><a href="#example1%20code">link to code</a><br />
<a href="./plots/cdf.png">high-resolution image</a></p>
<p>The first submission discussed during this webinar was a cumulative distribution function (CDF) plot with the cumulative proportion of subjects on the vertical axis and the satisfaction with life on the horizontal axis. This horizontal axis has been reversed, ranging from highest satisfaction (10; on the left) to lowest satisfaction (0; on the right). This is also highlighted by the arrow labelled “Less satisified”, which is very helpful. The curves show the proportion of subjects reaching a certain level of satisfaction or higher. The difference between non-smokers and smokers can be clearly seen in this graph, with non-smokers being more satisfied with life than smokers. This message is also communicated in the title of the graph.</p>
<p>The graph is very well designed with little to no visual clutter, which helps to focus on the actual data. A suggestion for improvement would be to place the subgroup labels directly next to the lines and to use the same color for the subgroup labels that was used for the lines which would allow removing the legend symbols.</p>
<p>To further highlight the difference between the two groups, it could be helpful to fill the area between the two curves using the color of the more satisfied group (or vice versa). This could even be shown as an additional bar chart below this visualization. This would facilitate comparing subgroup differences at the various cut-offs.</p>
<p>In summary, this graph is very effective for communicating a simple and clear message and could be used in a presentation. It appears that the creator of this graph already went through the process of exploring the data to reach the conclusion that smoking status is a relevant factor for satisfaction of life. Examples for exploratory visualizations that could help with reaching such a conclusion were also submitted and are discussed further below.</p>
<p><a id="example2"></a></p>
<h1 id="example-2.-treeplot-0850---1210">Example 2. Treeplot (08:50 - 12:10)</h1>
<figure>
<img src="plots/tree.png" title="Plot 2" alt="Plot 2" /><figcaption>Plot 2</figcaption>
</figure>
<p><a href="#example2%20code">link to code</a><br />
<a href="./plots/tree.png">high-resolution image</a></p>
<p>The second submission discussed during the webinar was a treeplot. The title contains the question that was posed to the participants and the subtitle describes that the tile sizes are proportional to the subgroup sizes. The mean satisfaction within subgroups is color-coded, as shown in the legend.</p>
<p>This plot gives a quick overview of the subgroups, allowing to see all the data visually in one place, which is great. The use of the font size could be improved. At first glance, it appears that it was coded with the data, but it seems it has more to do with the space constraints and the size of the tiles. For example, the font size for smoking status “N” and “Y” is the same but the size of the tiles indicates that the non-smoker group is much larger compared to the smoker group.</p>
<p><a id="example3"></a></p>
<h1 id="example-3.-bar-plots-1210---1720">Example 3. Bar plots (12:10 - 17:20)</h1>
<figure>
<img src="plots/bar.png" title="Plot 3" alt="Plot 3" /><figcaption>Plot 3</figcaption>
</figure>
<p><a href="#example3%20code">link to code</a><br />
<a href="./plots/bar.png">high-resolution image</a></p>
<p>The next visualization was specifically designed for a presentation. It starts of with a question (“How meaningful is a mean difference?”) and tries answering that question through a series of bar plots, looking at the data in different ways. This submission focuses on one single factor (smoking status), as already seen in the CDF plot above.</p>
<p>The first bar plot in the top left shows a statistically significant mean difference on an adapted scale from 6 to 8. In the top right we can see a very similar plot but this time on the complete scale from 0 to 10, which makes the magnitude of the difference appear much smaller. The stacked bar plot at the bottom shows a significant difference between the two response distributions instead of only comparing the means. Like the CDF plot, this visualization shows that non-smokers are performing better than smokers, regardless of the cut-off that is chosen.</p>
<p>Interestingly, a divergent color scheme was used in the stacked bar chart. A suggestion to make the comparisons in the stacked bar chart even easier would be to add reference lines connecting the different areas/cut-offs.</p>
<p>In summary, this is a well thought through visualization example.</p>
<p><a id="example4"></a></p>
<h1 id="example-4.-power-bi-dashboard-1720---2645">Example 4. Power BI dashboard (17:20 - 26:45)</h1>
<figure>
<img src="plots/powerbi.png" title="Plot 4" alt="Plot 4" /><figcaption>Plot 4</figcaption>
</figure>
<p><a href="#example4%20code">link to code</a><br />
<a href="./plots/powerbi.png">high-resolution image</a></p>
<p>This submission is an interactive Power BI dashboard. The number of participants and overall mean is given in the top left. A stacked bar chart as well as a classic bar plot show the distribution of the satisfaction responses. The factors are shown in supplementary bar plots below. In these bar plots a subgroup can be selected and all the other plots will adapt automatically. Check out the recording of the webinar <a href="https://www.psiweb.org/vod/item/psi-vissig-webinar-wonderful-wednesday-4">here</a> (starting at 17:20) to see how the interactivity works in practice.</p>
<p>This can be a very useful and easy tool to explore the data, replacing many tables. The arrangement of the different tiles on the dashboard seems also well thought through, starting with the main results in the top left and finishing with the summary results in the bottom right.</p>
<p>It is not entirely clear why some of the bar plots are vertical while others are horizontal. A horizontal presentation can be useful when labels are long to increase readibility, however, a consistent approach could be chosen.</p>
<p><a id="example5"></a></p>
<h1 id="example-5.-funnel-plot-2645---3720">Example 5. Funnel plot (26:45 - 37:20)</h1>
<figure>
<img src="plots/funnel1.png" title="Plot 5" alt="Plot 5" /><figcaption>Plot 5</figcaption>
</figure>
<p><a href="#example5%20code">link to code</a><br />
<a href="./plots/funnel1.png">high-resolution image</a></p>
<p>The next submission is an interactive visualization as well. In this funnel plot, each dot represents a subgroup estimate. This is the first visualization that does not only explore the factors in isolation, but also looks at all possible combination of subgroups. The overall mean with 95% prediction intervals is also shown. The vertical axis represents the average satisfaction ranging from 0 to 10 and the horizontal axis the subgroup size, i.e., larger subgroups are shown more to the right.</p>
<p>The name, the size and the mean of a specific subgroup becomes visible by hovering over a dot. This tool is specifically useful to explore extreme values. Check out the recording of the webinar <a href="https://www.psiweb.org/vod/item/psi-vissig-webinar-wonderful-wednesday-4">here</a> (starting at 26:45) to see how the interactivity works in practice.</p>
<p>Most data points are squeezed towards the top left of the plot, given that the full scale is shown on both axes, causing a lot of white space. The visualization does include an interactive zooming option. A couple of other suggestions to allow zooming in are: 1) the subgroup size could be shown on a logarithmic scale; 2) apply a minimum threshold to the subgroup size because the very small subgroups are usually not of interest.</p>
<p>Additional interesting interactive tools could be: 1) highlight all subgroups related to a certain factor, e.g., all subgroups relevant for smoking status. This would allow quicker identification of relevant factors. 2) when hovering over one subgroup, the complement of this subgroup could be highlighted as well.</p>
<p>In summary, this is a great, innovative idea to explore subgroups.</p>
<p><a id="example6"></a></p>
<h1 id="example-6.-funnel-plot-3720---4845">Example 6. Funnel plot (37:20 - 48:45)</h1>
<figure>
<img src="plots/funnel2.png" title="Plot 6" alt="Plot 6" /><figcaption>Plot 6</figcaption>
</figure>
<p><a href="#example6%20code">link to code</a><br />
<a href="./plots/funnel2.png">high-resolution image</a></p>
<p>This submission is similar to the funnel plot seen above but providing additional features, such as:</p>
<ul>
<li>Specific subgroups can be highlighted. For example, by selecting the non-smokers, it becomes apparent that most subgroups including non-smokers lie above the mean reference line.</li>
<li>The shading of the dots is linked to the number of subgroup levels. The white dots represent single-level factors while the more transparent dots represent higher level subgroups. The number of subgroup levels displayed can also be controlled (e.g., only 1-factorial subgroups could be displayed).</li>
<li>All parent subgroups of a selected subgroup can be highlighted. This could be used to explore the driving factors among a combination of factors forming a subgroup.</li>
</ul>
<p>Check out the recording of the webinar <a href="https://www.psiweb.org/vod/item/psi-vissig-webinar-wonderful-wednesday-4">here</a> (starting at 37:20) to see more details.</p>
<h1 id="code">Code</h1>
<p><a id="example1 code"></a></p>
<h2 id="example-1.-cdf-plot-r">Example 1. CDF plot (R)</h2>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
### Load packages
library(here)
library(tidyverse)

### Load data
data &lt;- data.frame(read_delim(here(&quot;Satisfaction_wW2005.csv&quot;), delim=&#39;;&#39;))
data$smoker &lt;- ifelse(data$smoker == &quot;Y&quot;, &quot;Smoker&quot;, ifelse(data$smoker == &quot;N&quot;, &quot;Non-smoker&quot;, NA))

### Only keep non-missing data
data_nonmiss &lt;- na.omit(data[, c(&quot;satisfaction&quot;, &quot;smoker&quot;)])

### Derive number of subjects within subgroups
n &lt;- data_nonmiss %&gt;% group_by(smoker) %&gt;% summarize(n = n())
  
### Create label variable including number of subjects
data_n &lt;- merge(data_nonmiss, n, by = &quot;smoker&quot;)
data_n$group &lt;- paste0(data_n$smoker, &quot; (n = &quot;, data_n$n, &quot;)&quot;)
  
### Plot
ggplot(data = data_n, aes(x = satisfaction, colour = group)) +
  stat_ecdf(size = 1, alpha = 0.5) +
  theme_minimal(base_size = 15) +
  scale_x_reverse(name = &quot;Satisfaction with life&quot;, breaks = seq(0, 10, 1), minor_break = NULL) +
  scale_y_continuous(name = &quot;Cumulative proportion of subjects&quot;, breaks = seq(0, 1, 0.25), minor_break = NULL) +
  scale_color_manual(name = NULL, values = c(&quot;#E7B800&quot;, &quot;#2E9FDF&quot;)) +
  theme(legend.position = c(0.15, 0.85)) +
  geom_segment(aes(x = 4.5, y = 0.5, xend = 2.5, yend = 0.5), colour = &quot;black&quot;, size = 1, arrow = arrow(length = unit(0.5, &quot;cm&quot;))) +
  annotate(&quot;text&quot;, x = 3.5, y = 0.53, label = &quot;Less satisfied&quot;, size = 5, colour = &quot;black&quot;) +
  ggtitle(&quot;Non-smokers more satisfied with life than smokers&quot;) +
  NULL

ggsave(file = here(&quot;cdf_smoker.png&quot;), width = 35, height = 20, units = &quot;cm&quot;)</code></pre>
</div>
<p><a href="#example1">Back to blog</a></p>
<p><a id="example2 code"></a></p>
<h2 id="example-2.-treeplot-r">Example 2. Treeplot (R)</h2>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(ggplot2)
if (!require(&#39;treemapify&#39;)) install.packages(&#39;treemapify&#39;);
if (!require(&#39;dplyr&#39;)) install.packages(&#39;dplyr&#39;);
if (!require(&#39;RColorBrewer&#39;)) install.packages(&#39;RColorBrewer&#39;);
library(treemapify)
library(dplyr)
library(RColorBrewer)

# read data
data &lt;- read.csv(url(&#39;https://raw.githubusercontent.com/VIS-SIG/Wonderful-Wednesdays/master/data/2020/2020-05-13/Satisfaction_wW2005.csv&#39;), na.strings = c(&quot;.&quot;, &quot;&quot;), header = TRUE)

foo_summarize&lt;- function(dat = data, my_var = NULL, group_label = &quot;NA&quot;){
    
   suppressWarnings(
     ans&lt;- dat %&gt;%
        filter(!is.na(satisfaction)) %&gt;%
        group_by({{my_var}}) %&gt;%
        summarize(n = n(), 
                  mean_satisfaction = mean(satisfaction)) %&gt;%
        mutate(percent = n / sum(n)*100) %&gt;%
        mutate(group = group_label) %&gt;%
        rename(Variable = names(.)[1])
   )
  
   return(ans)
}

#age
d_age&lt;- foo_summarize(dat=data, my_var=age, group_label = &quot;Age&quot;)
d_bmi&lt;- foo_summarize(dat=data, my_var=bmi, group_label = &quot;BMI&quot;)
d_w_hours&lt;- foo_summarize(dat=data, my_var=w_hours, group_label = &quot;Working hours&quot;)
d_todoctor&lt;- foo_summarize(dat=data, my_var=todoctor, group_label = &quot;Doctor visits per year&quot;)
d_income&lt;- foo_summarize(dat=data, my_var=income, group_label = &quot;Net income&quot;)
d_smoker&lt;- foo_summarize(dat=data, my_var=smoker, group_label = &quot;Smoker&quot;)
d_gender&lt;- foo_summarize(dat=data, my_var=gender, group_label = &quot;Gender&quot;)
d_employed&lt;- foo_summarize(dat=data, my_var=employed, group_label = &quot;Employment status&quot;)
d_graduat&lt;- foo_summarize(dat=data, my_var=graduat, group_label = &quot;Graduation&quot;)
d_graduat_f&lt;- foo_summarize(dat=data, my_var=graduat_f, group_label = &quot;Graduation of father&quot;)
d_graduat_m&lt;- foo_summarize(dat=data, my_var=graduat_m, group_label = &quot;Graduation of mother&quot;)
d_high_grad&lt;- foo_summarize(dat=data, my_var=high_grad, group_label = &quot;Highest educational grade&quot;)
d_high_grad_f&lt;- foo_summarize(dat=data, my_var=high_grad_f, group_label = &quot;Highest educational grade (father)&quot;)
d_high_grad_m&lt;- foo_summarize(dat=data, my_var=high_grad_m, group_label = &quot;Highest educational grade (mother)&quot;)

d_all&lt;- do.call(rbind, list(d_age, d_bmi, d_w_hours, d_todoctor, d_income, d_smoker, d_gender, d_employed, d_graduat,
                            d_graduat_f, d_graduat_m, d_high_grad, d_high_grad_f, d_high_grad_m))

# replace NA with a category: Missing. Only explanatory vars are affected. Response (satisfaction) has no missings
d_all$Variable&lt;- as.character(d_all$Variable)
d_all$Variable[which(is.na(d_all$Variable))]&lt;- &quot;Missing&quot;

# create descrete response variable to display colors in the plot better
d_all$satisfation_categories&lt;- cut(d_all$mean_satisfaction, 
                                   breaks=seq(round(min(d_all$mean_satisfaction)), round(max(d_all$mean_satisfaction)), 0.5), 
                                   labels=c(&quot;(6,6.5]&quot;, &quot;(6.5,7]&quot;, &quot;(7,7.5]&quot;, &quot;(7.5,8]&quot;, &quot;(8,8-5]&quot;, &quot;(8.5-9]&quot;), right = TRUE)

# create response with label
d_all$satisfaction_lab&lt;- paste(d_all$Variable, &quot; (&quot;, round(d_all$mean_satisfaction, 1), &quot;)&quot;, sep = &quot;&quot;)

# colors for plot
col_palette&lt;- display.brewer.pal(n = 6, name = &#39;RdYlBu&#39;)
palette&lt;- brewer.pal(n = 6, name = &#39;RdYlBu&#39;)



# plot
ggplot(d_all, aes(area=percent, label = Variable, fill = satisfation_categories, subgroup = group)) + 
            geom_treemap() + 
            geom_treemap_subgroup_border(size = 1.5, color = &quot;black&quot;) +
            geom_treemap_text(grow = T, reflow = T, place = &quot;topleft&quot;, layout = &quot;scol&quot;, min.size = 1,
                              color = &quot;Darkblue&quot;, size = 10) +
            scale_fill_manual(values = palette) + 
            facet_wrap( ~ group) + 
            theme(legend.position = &quot;bottom&quot;, 
                  legend.text = element_text(color=&quot;black&quot;, size = 18), 
                  legend.title = element_text(size = 18),
                  plot.title = element_text(size = 24),
                  plot.subtitle = element_text(size = 20), 
                  plot.caption = element_text(size = 14),
                  strip.text = element_text(size = 14, face = &quot;bold&quot;, color = &quot;Darkblue&quot;)) +
            labs(title = &#39;How would you rate your satisfaction with your life overall on a scale from 0-10? (10=completely satisfied)&#39;,
                 subtitle = &#39;Descriptive analysis by subgroup: tiles are proportional to rel. frequencies of the choices within a subgroup&#39;,
                 caption =&quot;Created with ggplot2-treemapify&quot;,
                 fill = &quot;Mean Satisfaction&quot;)


ggsave(&quot;treeplot_may2020.png&quot;, width = 24, height = 12, units=&quot;in&quot;, dpi = 300)</code></pre>
</div>
<p><a href="#example2">Back to blog</a></p>
<p><a id="example3 code"></a></p>
<h2 id="example-3.-bar-plots-r">Example 3. Bar plots (R)</h2>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(tidyverse)
library(Stack)
library(viridis)
library(IOHanalyzer)
library(car)
library(RColorBrewer)
display.brewer.all(colorblindFriendly = TRUE)
library(cowplot)
library(dgof)

#Colour Scheme
Orange &lt;- &quot;#EF7F04&quot;
Green &lt;- &quot;#68B937&quot;
Blue &lt;- &quot;#00A6CB&quot;
Grey &lt;- &quot;#4E5053&quot;
Darkblue &lt;- &quot;#003569&quot;
Yellow &lt;- &quot;#FFBB2D&quot;

#Load in data and make satisfaction and all other variables a factor. Also make a numeric version of satisfation for use late
Cohort &lt;- read_csv(&#39;Cohort.csv&#39;) %&gt;%
  mutate(satisfaction = factor(satisfaction, level=c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10))) %&gt;%
  mutate_all(factor) %&gt;%
  mutate(NumSat = as.numeric(satisfaction)) %&gt;%
  mutate(NumSat = NumSat-1) #To put it back on a 0-10 scale

#Calculate means for the groups
means &lt;- Cohort %&gt;%
  group_by(smoker) %&gt;% 
  summarise(
    NumSat = mean(NumSat, na.rm = TRUE) 
  ) %&gt;%
  filter(!is.na(smoker)) #filter out the means for patients without a value for smoking (some implicit NA&#39;s)

#Significance test of mean differences
model &lt;- lm(NumSat ~ smoker, data = Cohort)
summary(model)

#test of distributions
SmokerSat &lt;- Cohort %&gt;%
  select(smoker, NumSat) %&gt;%
  filter(smoker==&quot;Y&quot;)

NonSmokerSat &lt;- Cohort %&gt;%
  select(smoker, NumSat) %&gt;%
  filter(smoker==&quot;N&quot;)

KS &lt;- ks.test(SmokerSat$NumSat, NonSmokerSat$NumSat)


#Make plot of means, 
p &lt;- ggplot(means, aes(x=smoker, y=NumSat)) +
  geom_bar(stat=&quot;identity&quot;, fill=Darkblue, color=&quot;black&quot;, xpd = FALSE) +
  scale_y_continuous(name = &quot;Satisfaction (0-10)&quot;) +
  scale_x_discrete(name = &quot;Smoking History&quot;, 
                   labels=c(&quot;Non-Smoker&quot;,&quot;Current Smoker&quot;))


#Fake plot for  aesthetic purporposes (remove the bar going below &quot;6&quot; on the chart with the reduced y axis)
   #Start with fake dataset
smoker &lt;- c(&quot;N&quot;, &quot;Y&quot;)
NumSat &lt;-c(6,6)
fake.data &lt;- data.frame(smoker,NumSat)


# make plot 1 where the scale is changed to emphasize difference
plot1 &lt;- p+coord_cartesian(ylim=c(6,8.1))+
  theme_classic() +
  theme(line = element_blank()) +
  geom_bar(data=fake.data,stat=&quot;identity&quot;, fill=&quot;white&quot;, color=&quot;white&quot;) +  #Add a white rectangle below the &quot;6.0&quot; line using fake data
  ggtitle(&quot;A statistically significant difference in Satisfaction between Non-smokers and Smokers \n highlighted by using misleading axis... \n&quot;) +
  theme (plot.title = element_text(family = &quot;sans&quot;, color=Grey, face=&quot;bold&quot;, size=14, hjust=0.5)) + #Edit font
  annotate(&quot;segment&quot;, x = &quot;N&quot;, xend = &quot;Y&quot;, y = 8.0, yend = 8.0,
           colour = &quot;black&quot;) +
  annotate(&quot;segment&quot;, x = &quot;N&quot;, xend = &quot;N&quot;, y = 8.0, yend = 7.9,
           colour = &quot;black&quot;) +
  annotate(&quot;segment&quot;, x = &quot;Y&quot;, xend = &quot;Y&quot;, y = 8.0, yend = 7.9,
           colour = &quot;black&quot;) + 
  annotate(&quot;segment&quot;, x = 1.5, xend = 1.58, y = 8.0, yend = 8.1,
           colour = &quot;black&quot;) +
  annotate(geom = &quot;text&quot;, x = 1.6, y = 8.05, label = &quot;Significant!&quot;, hjust = &quot;left&quot;, vjust = &quot;bottom&quot;, size = 6) +
  annotate(geom = &quot;text&quot;, x = 2.0, y = 8.05, label = &quot;(p&lt;0.001)&quot;, hjust = &quot;left&quot;, vjust = &quot;bottom&quot;, size = 2) 
  

# make plot 2 which uses oringinal 0-10 scale
plot2 &lt;- p+coord_cartesian(ylim=c(0,10)) +
  theme_classic() +
  theme(line = element_blank()) + 
  ggtitle(&quot;.. But when plotted using the 0-10 scale, the true (small) magnitude of \n this difference is apparent \n &quot;) +
  theme (plot.title = element_text(family = &quot;sans&quot;, color=Grey, face=&quot;bold&quot;, size=14, hjust=0.5)) + #Edit font
  annotate(&quot;segment&quot;, x = &quot;N&quot;, xend = &quot;Y&quot;, y = 9.6, yend = 9.6,
           colour = &quot;black&quot;) +
  annotate(&quot;segment&quot;, x = &quot;N&quot;, xend = &quot;N&quot;, y = 9.6, yend = 9.1,
           colour = &quot;black&quot;) +
  annotate(&quot;segment&quot;, x = &quot;Y&quot;, xend = &quot;Y&quot;, y = 9.6, yend = 9.1,
           colour = &quot;black&quot;) + 
  annotate(&quot;segment&quot;, x = 1.5, xend = 1.33, y = 9.6, yend = 10,
           colour = &quot;black&quot;) +
  annotate(geom = &quot;text&quot;, x = 1.3, y = 9.8, label = &quot;Meaningful?&quot;, hjust = &quot;right&quot;, vjust = &quot;bottom&quot;, size = 6) 



# make plot 3 - a staked bar chart to show distributional changes
Cohort$smoker %&gt;% mutate(fct_reorder(smoker, NumSat, .fun=&quot;mean&quot;))


plot3 &lt;- ggplot(data=subset(Cohort, !is.na(smoker)), aes(y = reorder(smoker, NumSat))) +
  geom_bar(aes(fill = satisfaction), position = position_fill(reverse = TRUE)) +
  scale_fill_brewer(palette=&quot;BrBG&quot;) +
  guides(fill = guide_legend(nrow = 1)) +
  ggtitle(&quot;Significant difference between the two response distributions \n (D=0.14, p&lt;.001)&quot;) +
  theme_classic() +
  theme(line = element_blank()) +
  theme(legend.position = &quot;bottom&quot;, legend.box = &quot;horizontal&quot;)+
  xlab(&quot;Proportion of participants selecting each &#39;Satisfaction&#39; value&quot;) + 
  scale_y_discrete(name = &quot;Smoking History&quot;, 
                   labels=c(&quot;Current Smoker&quot;,&quot;Non-Smoker&quot;)) +
  scale_x_continuous(breaks = c(0, .25, .50, .75, 1.00))
  ggtitle(&quot;The response distribution shows that smokers reported lower satisfaction scores (0-5) more often than non-smokers \n and higher satisfaction scores (9-10) less often than non-smokers&quot;) +
  theme (plot.title = element_text(family = &quot;sans&quot;, color=Grey, face=&quot;bold&quot;, size=18, hjust=0.5))  #Edit font
  
#plot3 &lt;- plot3 +  annotate(geom = &quot;curve&quot;, x = 0.50, y = 2.60, xend = 0.65, yend = 2.45, 
#           curvature = -.25, arrow = arrow(length = unit(3, &quot;mm&quot;))
#  ) +
#  annotate(geom = &quot;text&quot;, x = 0.5, y = 2.55, label = &quot;Significant difference in distributions \n (D=0.14, p&lt;.001)&quot;, hjust = &quot;center&quot;, size = 3)

#design layout
  # Make a title
title &lt;- ggdraw() + 
  draw_label(
    &quot;How Meaningful is a Mean Difference?&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0,
    size = 22
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )

top_row &lt;- plot_grid(plot1, plot2, labels = c(&quot;A&quot;, &quot;B&quot;), align = &quot;h&quot;)
Faceted_graphs &lt;- plot_grid(top_row, plot3, labels = c(&#39; &#39;, &#39;C&#39;), label_size = 12, ncol = 1)

plot_grid(title, Faceted_graphs,  
          ncol = 1,
          # rel_heights values control vertical title margins
          rel_heights = c(0.1, 1)
  )</code></pre>
</div>
<p><a href="#example3">Back to blog</a></p>
<p><a id="example4 code"></a></p>
<h2 id="example-4.-power-bi-dashboard">Example 4. Power BI dashboard</h2>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
PSI survey

https://app.powerbi.com/view?r=eyJrIjoiOTZkOTVkYTEtMzE3OC00YTAzLWIyZGYtODZhZWYwYzM5MzQ1IiwidCI6ImY1NTgwM2MzLTRmYTktNDIzMy1hOGFiLTIxM2I3ZWI3MjEzNCJ9</code></pre>
</div>
<p><a href="#example4">Back to blog</a></p>
<p><a id="example5 code"></a></p>
<h2 id="example-5.-funnel-plot-r">Example 5. Funnel plot (R)</h2>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
##### code for funnel plot for submittion
library(doParallel)
library(data.table)
library(plotly)
library(tidyverse)

data_transform &lt;- function(x, 
                           labels = c(&quot;low&quot;, &quot;high&quot;), 
                           except = NULL, 
                           threshold = 0.1, 
                           explicit_conv = NULL, 
                           explicit_conv_override = FALSE, 
                           binary_categories = FALSE, 
                           n_binary_categories=1, 
                           verbose = FALSE) {
  
  x_new &lt;- x
  cutoff &lt;- floor(threshold * nrow(x_new)) # if number of unique values is less than 10% of overall dataset size, treat corresponding covariate as categorical
  if(!is.null(explicit_conv) &amp;&amp; explicit_conv_override){
    cutoff &lt;- Inf
  }
  for (column in colnames(x_new)[!colnames(x_new) %in% except]) {
    fac &lt;- as.factor(x[, column])
    if ((nlevels(fac) &gt; cutoff) || column %in% explicit_conv) {
      if (!binary_categories) {
        n_quant &lt;- length(labels) # number of quantiles
        quant &lt;- quantile(x_new[, column], probs = 0:n_quant / n_quant, na.rm = TRUE)
        if (verbose) {message(sprintf(&quot;Transforming %s to categorical using following quantiles&quot;, column))}
        if (verbose) {message(paste0(capture.output(quant), collapse = &quot;\n&quot;))}
        x_new[, column] &lt;- cut(x_new[, column], quant, include.lowest = TRUE, labels = labels)
      } else {
        n_quant &lt;- n_binary_categories+1 # number of quantiles
        quant &lt;- quantile(x_new[, column], probs = 0:n_quant / n_quant, na.rm = TRUE)
        if (verbose) {message(sprintf(&quot;Transforming %s to binary categorical columns using following quantiles&quot;, column))}
        if (verbose) {message(paste0(capture.output(quant), collapse = &quot;\n&quot;))}
        for (j in 2:(length(quant) - 1)) {
          x_new[, sprintf(&quot;%s_q%s&quot;, column, substr(names(quant)[j], 1, 2))] &lt;-
            as.factor(cut(x_new[, column], c(quant[1], quant[j], quant[length(quant)]), include.lowest = TRUE, labels = FALSE))
          levels(x_new[, sprintf(&quot;%s_q%s&quot;, column, substr(names(quant)[j], 1, 2))]) &lt;- c(0, 1)
        }
        # remove orignal column
        x_new[, column] &lt;- NULL
      }
    }
    else if (typeof(x[, column]) != &quot;integer&quot;) {
      if (verbose) {message(sprintf(&quot;Convert %s to factors&quot;, column))}
      x_new[, column] &lt;- as.factor(x[, column])
    }
  }
  
  return(x_new)
}




return_subgroups &lt;- function(x, 
                             eval_fun, 
                             covs, 
                             packages=NULL, 
                             comb = 3, 
                             comb_lowerbound = 1, 
                             n_cores = 1, 
                             first_N = Inf, 
                             verbose = !(first_N==Inf)) {
  
  
  
  data_cov_comb &lt;- function(vec, k, n = length(vec),verbose = FALSE) {
    # returns all n over k combinations of elements in vec
    # n should be size of vec and k&lt;=n
    if(verbose){message(sprintf(&quot;Computing %s combinations out of&quot;,k))}
    if(verbose){message(paste0(capture.output(vec), collapse = &quot;\n&quot;))}
    return(gtools::combinations(n, k, vec))
  }
  
  
  data_level_comb &lt;- function(x, covs) {
    # takes a dataframe x where every column is of type integer/factor and computes all combinations between all the levels of covariates specified in covs
    return(tidyr::expand(x, x[covs]))
  }
  
  compute_eval &lt;- function(x, covs, eval_fun, first_N_active = FALSE) {
    # computes the evaluation function on all subgroup combination of given covariates in covs (vector of strings)
    # returns a list with number of entrys equal to the number of possible covariate level combinations.
    # Each entry consits of two elements:
    # first entry contains the filtered dataset containing only subgroup datapoints
    # second entry contains single line dataframe output of eval_func augmented by subgroup labels
    comb &lt;- data_level_comb(x, covs)
    
    if (first_N_active) {
      if (first_N_count &lt;= nrow(comb)) {
        comb &lt;- comb[1:first_N_count, ]
        first_N_count &lt;&lt;- 0
      } else {
        first_N_count &lt;&lt;- first_N_count - nrow(comb)
      }
    }
    
    subframes &lt;- foreach(i = 1:nrow(comb)) %do% {
      x_filtered &lt;- x
      for (j in 1:length(covs)) {
        x_filtered &lt;- dplyr::filter(x_filtered, x_filtered[covs[j]] == as.character(unlist(comb[i, j])))
      }
      result &lt;- eval_fun(x_filtered)
      result[covs] &lt;- comb[i, ]
      
      return(result)
    }
    return(subframes)
  }
  
  #check if provided covs are contained in x
  for (name in covs) {
    if (!(name %in% colnames(x))) {
      stop(sprintf(&quot;Variable %s was not found in %s&quot;, name, toString(substitute(x))))
    }
  }
  
  #turn on verbose if first_N != Inf 
  if (first_N!=Inf){verbose &lt;- TRUE} 
  
  cl &lt;- makeCluster(n_cores)
  registerDoParallel(cl)
  
  if(verbose){message(sprintf(&quot;Number of cores: %s&quot;, getDoParWorkers()))}
  
  # computes the evaluation function on all subgroup combination of given covariates in covs (vector of strings) for 1,2 and 3 combinations(general: comb_lowerbound:comb)
  if (first_N == Inf) {
    results &lt;- foreach(i = comb_lowerbound:comb, .combine = c) %do% {
      covs_comb &lt;- data_cov_comb(covs, i,verbose=verbose)
      track_time &lt;- system.time({
        result &lt;- foreach(j = lapply(as.list(1:dim(covs_comb)[1]), function(x) covs_comb[x[1],]), .combine = c, .packages = c(&quot;foreach&quot;, packages)) %dopar% {
          compute_eval(x, j, eval_fun)
        }
      })
      if(verbose){message(paste0(capture.output(track_time), collapse = &quot;\n&quot;))}
      return(result)
    }
  } else {
    if(verbose){message(sprintf(&quot;Computing first %d subgroups using single core&quot;, first_N))}
    first_N_count &lt;&lt;- first_N
    results &lt;- foreach(i = comb_lowerbound:comb, .combine = c) %do% {
      covs_comb &lt;- data_cov_comb(covs, i,verbose=verbose)
      track_time &lt;- system.time({
        result &lt;- foreach(j = 1:min(nrow(covs_comb), first_N), .combine = c, .packages=c(packages)) %do% {
          if (first_N_count == 0) {
            return()
          }
          res &lt;- compute_eval(x, covs_comb[j, ], eval_fun, first_N_active = TRUE)
        }
      })
      if(verbose){message(paste0(capture.output(track_time), collapse = &quot;\n&quot;))}
      return(result)
    }
  }
  
  stopCluster(cl)
  
  return(dplyr::bind_rows(results))
}

############################################################################################
############# read data
dat &lt;- read.csv(&quot;./Satisfaction_wW2005.csv&quot;) %&gt;%
  as.data.frame() %&gt;% dplyr::select(-X, -ID) 

### global mean and se
dat_mean &lt;- mean(dat$satisfaction)
dat_se &lt;- sd(dat$satisfaction)/sqrt(nrow(dat))
dat_sd &lt;- sd(dat$satisfaction)

fit &lt;- function(x) {
  cf1 &lt;- tryCatch({
    cf &lt;- mean(x$satisfaction)
    se &lt;- sd(x$satisfaction)/sqrt(nrow(x))
    c(cf, se,nrow(x))
  },
  warning = function(w) { #warning handling
    NA
  }, error = function(w) { #error handling
    c(dat_mean,dat_se,0)
  }
  )
  return(data.frame(av = cf1[1], se = cf1[2], N = cf1[3]))
}

subgroups &lt;- return_subgroups(dat, 
                              fit,
                              comb = 3, 
                              comb_lowerbound = 1,
                              covs = colnames(dat)[1:14],
                              # first_N = 100, 
                              n_cores = 4,
                              verbose = TRUE)
# head(subgroups)

nams &lt;- names(subgroups)[-c(1:3)]
subgroups$text &lt;- NULL
subgroups$text &lt;- apply(subgroups, 1, function(x){
  covs &lt;- x[-c(1:3)]
  ind &lt;- which(!is.na(covs))
  p1 &lt;- NULL
  for(i in 1:length(ind)){
    p1 &lt;- c(p1, sprintf(&quot;%s=%s&quot;, nams[ind[i]], covs[ind[i]]))
  }
  p1 &lt;- paste(p1, collapse=&quot;,&quot;)
  p2 &lt;- sprintf(&quot;|satisfaction=%.1f, N=%d&quot;, as.numeric(x[1]),as.numeric(x[3]))
  paste0(p1, p2)
})


## calculate dfs (assuming balance)
n_start &lt;- 2
N &lt;- n_start:nrow(dat)
q95 &lt;- qt(0.975, df= N - 1)
ci &lt;- data.frame(N = N,
                 lb = dat_mean - q95*dat_sd/sqrt(N),
                 ub = dat_mean + q95*dat_sd/sqrt(N))

fig &lt;- subgroups %&gt;% filter(N &gt;= n_start) %&gt;% 
  plot_ly(x = ~ N, y = ~av) %&gt;%
  add_markers(name = &#39;Subgroup Estimates&#39;,text = ~text, hoverinfo = &quot;text&quot;,
              color = I(&quot;blue&quot;), alpha=0.2)%&gt;%
  add_markers(x = nrow(dat), y = dat_mean,
              name = &#39;Overall Estimates&#39;,text = I(paste0(&quot;satisfaction = &quot;,round(dat_mean,2))), 
              hoverinfo = &quot;text&quot;,color = I(&quot;red&quot;),alpha=0.2)%&gt;%
  add_lines(x = ~ ci$N, y = ~ ci$lb, name = &#39;Lower 95% PI&#39;, hoverinfo = &#39;skip&#39;, 
            color = I(&quot;black&quot;), alpha=0.5) %&gt;%
  add_lines(x = ~ ci$N, y = ~ ci$ub, name = &#39;Upper 95% PI&#39;, hoverinfo = &#39;skip&#39;, 
            color = I(&quot;black&quot;), alpha=0.5) %&gt;%
  add_lines(x = I(n_start:nrow(dat)), y = dat_mean, 
            name = &quot;Overall mean&quot;,hoverinfo = &#39;skip&#39;, color = I(&quot;red&quot;),alpha=0.5) %&gt;%
  layout(xaxis = list(range = c(n_start,(nrow(dat)+4)),title = &quot;Subgroup size&quot;),
         yaxis = list(range = c(1, 10),title = &quot;Average satisfication&quot;))
fig
htmlwidgets::saveWidget(fig, &quot;./funnel_satisfaction.html&quot;)</code></pre>
</div>
<p><a href="#example5">Back to blog</a></p>
<p><a id="example6 code"></a></p>
<h2 id="example-6.-funnel-plot-r">Example 6. Funnel plot (R)</h2>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
###############################################################################
# Bayer AG
# Study            :
# Proj/Subst/GIAD  :
###############################################################################
# Name of program #############################################################
# Name             : SGS_WW2005.R
#
# Purpose          : Run subgroup screening  
# Programming Spec :
# Validation Level : 1 - Verification by Review
# R Version        : 4.0.0 (64 bit) on simulation server
###############################################################################
# Pre-conditions   : data source: ALLBUS dataset 2014/subset
# Post-conditions  :
# Comments         :
###############################################################################
# Author(s)        : Bodo Kirsch  03JUN2020
# Reference prog   : SGS
###############################################################################
# Changed by       : 
# Reason           :
###############################################################################



### delete workspace
rm(list=ls())


### AutoSub and load libraries
#setwd(&quot;c:/temp&quot;)


library(shiny)
library(subscreen)


### import data
D=read.csv2(file=&quot;Data_wW2005.csv&quot;, sep=&quot;,&quot;, dec=&quot;.&quot;, header=TRUE)


auwe &lt;- function(D){
  
    # --- satisfaction mean ----------------------------------------------------------------
  
      satisfact  &lt;- round(mean(D$satisfaction, na.rm = TRUE), 2)   # TRUE:  NA values stripped before the computation proceeds
      
      number.of.subjects     &lt;- sum(!is.na(D$satisfaction))
  
    return(data.frame(number.of.subjects, satisfact))
}


HH &lt;- subscreencalc(data=D,
           eval_function = auwe,
           endpoints   = &quot;satisfaction&quot;,  
           treat       = &quot;&quot;,            
           subjectid   = &quot;ID&quot;,
           factors     = c(&quot;gender&quot;, &quot;employed&quot;, &quot;smoker&quot;, &quot;graduat&quot;, &quot;graduat_f&quot;, &quot;graduat_m&quot;, 
                           &quot;high_grad&quot;, &quot;high_grad_f&quot;, &quot;high_grad_m&quot;, &quot;age&quot;, &quot;w_hours&quot;, &quot;todoctor&quot;, &quot;bmi&quot;, &quot;income&quot;) ,
           min_comb    = 1,
           max_comb    = 3,
           verbose     = T)



#write.csv(HH$sge, file = &quot;Data_H.csv&quot;, na=&quot;&quot;)    

subscreenshow(HH, 
              host = &quot;0.0.0.0&quot;, port = 1234)</code></pre>
</div>
<p><a href="#example6">Back to blog</a></p>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Vogler (2020, June 10). VIS-SIG Blog: Wonderful Wednesdays June 2020. Retrieved from https://vis-sig.github.io/blog/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{june-2020-ww,
  author = {Vogler, Markus},
  title = {VIS-SIG Blog: Wonderful Wednesdays June 2020},
  url = {https://vis-sig.github.io/blog/},
  year = {2020}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
