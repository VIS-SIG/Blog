The code is available at https://observablehq.com/d/93b698590f9dd7b2